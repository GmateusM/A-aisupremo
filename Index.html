<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>T√î COM FOME VR - Fa√ßa seu pedido</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet" />
<style>
  :root {
    --primary-red: #dc2626;
    --dark-red: #b91c1c;
    --text-red: #7f1d1d;
    --primary-yellow: #facc15;
    --light-yellow: #fefce8;
    --dark-yellow: #f59e0b;
    --font-display: 'Fredoka One', cursive;
    --font-body: 'Comic Neue', cursive;
  }
  /* Anima√ß√£o de entrada suave */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  html {
    scroll-behavior: smooth;
    scroll-padding-top: 150px; /* Ajuste para o header e nav fixos */
  }
  body {
    font-family: var(--font-body);
    background-color: var(--light-yellow);
    background-image: radial-gradient(var(--primary-yellow) 0.5px, transparent 0.5px), radial-gradient(var(--primary-yellow) 0.5px, var(--light-yellow) 0.5px);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
    color: var(--text-red);
  }
  header {
    background: var(--primary-red);
    color: var(--primary-yellow);
    text-shadow: 2px 2px 0px #00000020;
    border-bottom: 4px solid var(--dark-yellow);
  }
  header h1 {
    font-family: var(--font-display);
    font-size: 2.5rem;
    letter-spacing: 0.05em;
  }
  .logo-circle {
    background: var(--primary-yellow);
    border-radius: 50%;
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 3px solid var(--light-yellow);
    box-shadow: 0 4px 8px #00000030;
    transition: transform 0.3s ease;
  }
  .logo-circle:hover {
    transform: rotate(-15deg) scale(1.1);
  }
  /* Barra de Navega√ß√£o de Categorias */
  #category-nav {
    background-color: #ffffff;
    border-bottom: 3px dashed var(--dark-yellow);
    padding: 0.75rem 0;
    position: sticky;
    top: 85px; /* Altura do header */
    z-index: 20;
  }
  .category-btn {
    font-family: var(--font-display);
    background-color: var(--primary-yellow);
    color: var(--text-red);
    border: 2px solid var(--dark-red);
    transition: all 0.2s ease-in-out;
    flex-shrink: 0;
  }
  .category-btn:hover, .category-btn:focus {
    background-color: var(--dark-yellow);
    color: white;
    transform: scale(1.05);
    outline: 2px solid white;
  }
  h2.section-title {
    font-family: var(--font-display);
    font-size: 2.5rem;
    color: var(--dark-red);
    text-align: center;
    margin-bottom: 2rem;
    position: relative;
    padding-bottom: 0.5rem;
  }
  /* Linha decorativa para o t√≠tulo da se√ß√£o */
  h2.section-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 5px;
    background: var(--primary-yellow);
    border-radius: 5px;
    border: 2px solid var(--dark-red);
  }
  #checkout-btn {
    font-family: var(--font-display);
    transition: all 0.3s ease;
    box-shadow: 0 4px 0 var(--dark-red);
  }
  #checkout-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 0 var(--dark-red);
  }
  #checkout-btn:active:not(:disabled) {
    transform: translateY(2px);
    box-shadow: 0 2px 0 var(--dark-red);
  }
  #checkout-btn:disabled {
    box-shadow: none;
    background-color: #9ca3af;
    cursor: not-allowed;
  }
  button {
    cursor: pointer;
  }
  /* Estilos do Carrinho Flutuante */
  #cart-modal {
    background-color: var(--light-yellow);
    border-left: 5px solid var(--dark-yellow);
  }
  #cart-modal .section-title {
    font-size: 2rem;
  }
  #cart-items-container::-webkit-scrollbar {
    width: 8px;
  }
  #cart-items-container::-webkit-scrollbar-thumb {
    background: var(--primary-yellow);
    border-radius: 4px;
    border: 2px solid var(--light-yellow);
  }
  #cart-items-container::-webkit-scrollbar-track {
    background: #fffbeb;
  }
  .toast-notification {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    padding: 12px 24px;
    border-radius: 9999px;
    font-family: var(--font-display);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
  }
  .toast-notification.show {
    opacity: 1;
    transform: translateX(-50%) translateY(-10px);
  }
  .toast-success {
    background-color: #22c55e;
  }
  .toast-error {
    background-color: #ef4444;
  }
  /* Novos estilos para melhorias de acessibilidade */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--primary-red);
    color: white;
    padding: 8px;
    z-index: 100;
    border-radius: 0 0 4px 4px;
    transition: top 0.3s;
  }
  .skip-link:focus {
    top: 0;
  }
  .cart-item-total {
    font-weight: bold;
    color: var(--dark-red);
    margin-left: 10px;
  }
  .remove-item-btn {
    background: transparent;
    color: #ef4444;
    border: none;
    padding: 4px 8px;
    border-radius: 4px;
    margin-left: 10px;
    transition: all 0.2s;
  }
  .remove-item-btn:hover, .remove-item-btn:focus {
    background: #ef4444;
    color: white;
    outline: none;
  }
  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  /* Melhorias de foco para acessibilidade */
  button:focus, input:focus, a:focus {
    outline: 2px solid var(--dark-yellow);
    outline-offset: 2px;
  }
  /* Melhor contraste para texto */
  .text-red-800 {
    color: #991b1b;
  }
</style>
</head>
<body>
<!-- Link de pular navega√ß√£o para acessibilidade -->
<a href="#main-content" class="skip-link">Pular para o conte√∫do principal</a>

<header class="py-4 shadow-lg sticky top-0 z-30">
  <div class="container mx-auto flex items-center justify-between px-4 sm:px-6">
    <div class="flex items-center space-x-4">
      <div class="logo-circle">
        <img src="https://cdn-icons-png.flaticon.com/512/3075/3075977.png" alt="Logo T√¥ Com Fome VR - √çcone de hamb√∫rguer" />
      </div>
      <h1 class="text-2xl sm:text-4xl">T√î COM FOME VR</h1>
    </div>

    <div class="relative">
      <button id="cart-icon" class="cursor-pointer p-3 bg-yellow-400 rounded-full hover:bg-yellow-300 transition-all duration-300 shadow-md hover:scale-110" aria-label="Abrir carrinho de compras - Itens no carrinho: 0">
        <i class="fas fa-shopping-cart text-red-700 text-2xl" aria-hidden="true"></i>
        <span id="cart-count" class="absolute -top-1 -right-1 bg-red-700 text-yellow-400 text-xs rounded-full w-6 h-6 flex items-center justify-center font-bold" aria-live="polite">0</span>
      </button>
    </div>
  </div>
</header>

<!-- Menu de Navega√ß√£o R√°pida -->
<nav id="category-nav" class="shadow-md" aria-label="Navega√ß√£o por categorias de produtos">
    <div id="category-buttons-container" class="container mx-auto px-4 sm:px-6 flex items-center space-x-3 overflow-x-auto pb-2">
        <!-- Bot√µes ser√£o inseridos aqui pelo JavaScript -->
    </div>
</nav>

<main id="main-content" class="container mx-auto px-4 sm:px-6 py-12">
  <section id="menu" class="space-y-16"></section>
</main>

<!-- Carrinho Flutuante (Modal) -->
<div id="cart-backdrop" class="fixed inset-0 bg-black bg-opacity-60 z-40 hidden transition-opacity duration-300"></div>
<aside id="cart-modal" class="fixed top-0 right-0 h-full w-full max-w-md bg-yellow-50 z-50 transform translate-x-full transition-transform duration-300 ease-in-out flex flex-col shadow-2xl" aria-modal="true" role="dialog" aria-label="Carrinho de compras">
    <div class="flex justify-between items-center p-6 border-b-4 border-dashed border-yellow-500">
        <h2 class="section-title !mb-0 !border-none !pb-0 !text-left !text-3xl">üõí Meu Pedido</h2>
        <button id="close-cart-btn" class="text-red-700 hover:text-red-900 text-4xl font-bold leading-none transition-transform hover:rotate-90" aria-label="Fechar carrinho de compras">&times;</button>
    </div>

    <div id="cart-items-container" class="flex-grow p-6 space-y-4 overflow-y-auto min-h-0">
        <p id="cart-empty-msg" class="text-center text-red-800 py-8 font-bold text-lg">Seu carrinho est√° vazio!</p>
    </div>

    <div class="p-6 border-t-4 border-dashed border-yellow-500 bg-yellow-100">
        <div class="flex justify-between items-center mb-4">
            <div class="text-xl font-bold text-red-800">
                <span class="font-display">Total:</span>
                <span id="cart-total" aria-live="polite" class="font-display">R$ 0,00</span>
            </div>
            <button id="clear-cart-btn" class="text-sm text-gray-600 hover:text-red-600 hover:underline transition-all duration-200 hidden">
                <i class="fas fa-trash-alt mr-1" aria-hidden="true"></i> Esvaziar
            </button>
        </div>
        <div class="mt-4">
            <label for="address" class="block mb-2 font-bold text-red-800 font-display">Seu Endere√ßo:</label>
            <input type="text" id="address" name="address" class="w-full p-3 border-2 border-yellow-500 rounded-lg focus:ring-red-500 focus:border-red-500 bg-white shadow-inner" placeholder="Ex: Rua, N√∫mero, Bairro" required aria-describedby="address-help">
            <p id="address-help" class="text-sm text-gray-600 mt-1">Informe seu endere√ßo completo para entrega</p>
        </div>
        <button id="checkout-btn" class="mt-6 w-full bg-red-600 text-yellow-300 py-3 rounded-lg text-lg font-bold" disabled>
            <i class="fab fa-whatsapp" aria-hidden="true"></i> Finalizar Pedido
        </button>
    </div>
</aside>

<footer class="bg-red-900 text-yellow-300 mt-16 py-8">
    <div class="container mx-auto text-center">
        <p class="font-display">&copy; 2025 T√î COM FOME VR. Todos os direitos reservados.</p>
        <p class="text-sm mt-2">Feito com ‚ù§Ô∏è para matar sua fome!</p>
    </div>
</footer>

<div id="toast-container"></div>

<script>
// Web Component para o Card de Produto
class ProductCard extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
  }

  connectedCallback() {
    const name = this.getAttribute('name');
    const price = parseFloat(this.getAttribute('price')).toFixed(2);
    const oldPrice = this.getAttribute('oldPrice');
    const promo = this.getAttribute('promo') === 'true';
    const description = this.getAttribute('description');
    const img = this.getAttribute('img');
    const placeholderUrl = `https://placehold.co/400x200/fff8e1/b91c1c?text=Ops!+Imagem+n√£o+encontrada`;

    this.shadowRoot.innerHTML = `
      <style>
        :host { 
          display: block; 
          animation: fadeIn 0.5s ease-out forwards;
          opacity: 0;
        }
        .card { 
          transition: transform 0.3s ease, box-shadow 0.3s ease; 
          border-radius: 1.5rem; 
          box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
          background: #fff; 
          border: 4px solid #facc15; 
          overflow: hidden; 
          position: relative; 
          display: flex; 
          flex-direction: column; 
          height: 100%; 
        }
        .card:hover, .card:focus-within { 
          transform: translateY(-10px); 
          box-shadow: 0 20px 25px -5px rgba(220, 38, 38, 0.3), 0 10px 10px -5px rgba(220, 38, 38, 0.2);
        }
        .card-img-wrapper {
          overflow: hidden;
        }
        .card-img { 
          width: 100%; 
          height: 200px; 
          object-fit: cover;
          transition: transform 0.4s ease;
        }
        .card:hover .card-img, .card:focus-within .card-img {
          transform: scale(1.1);
        }
        .card-body { 
          padding: 1.25rem; 
          flex-grow: 1; 
          display: flex; 
          flex-direction: column; 
          background-color: #fefce8;
        }
        .card-title { 
          font-family: 'Fredoka One', cursive; 
          font-size: 1.3rem; 
          color: #b91c1c; 
          margin-bottom: 0.5rem; 
          min-height: 3.2rem; /* Garante alinhamento */
        }
        .card-description { 
          font-size: 0.9rem; 
          color: #9a3412; 
          margin-bottom: 1rem; 
          flex-grow: 1;
        }
        .price-section { 
          display: flex; 
          align-items: baseline; 
          margin-bottom: 1rem; 
        }
        .price-current { 
          font-size: 1.75rem; 
          font-weight: 700; 
          color: #9a3412; 
          font-family: 'Fredoka One', cursive; 
        }
        .price-old { 
          text-decoration: line-through; 
          color: #9ca3af; 
          font-size: 1rem; 
          margin-left: 0.5rem; 
        }
        .add-btn { 
          background-color: #facc15; 
          color: #7f1d1d; 
          font-family: 'Fredoka One', cursive; 
          padding: 0.75rem 1.5rem; 
          border-radius: 9999px; 
          border: 3px solid #7f1d1d;
          font-weight: 700; 
          cursor: pointer; 
          transition: all 0.2s ease; 
          width: 100%; 
          text-transform: uppercase;
          box-shadow: 0 4px 0 #f59e0b;
        }
        .add-btn:hover, .add-btn:focus { 
          background-color: #f59e0b; 
          transform: translateY(-2px);
          box-shadow: 0 6px 0 #f59e0b;
          outline: 2px solid white;
        }
        .add-btn:active {
          transform: translateY(2px);
          box-shadow: 0 2px 0 #f59e0b;
        }
        .promo-badge { 
          position: absolute; 
          top: 1rem; 
          right: -10px; 
          background: #dc2626; 
          color: #fefce8; 
          font-weight: 700; 
          font-size: 0.8rem; 
          padding: 5px 15px; 
          text-transform: uppercase; 
          font-family: 'Fredoka One', cursive; 
          box-shadow: 0 4px 6px rgba(0,0,0,0.2); 
          transform: rotate(15deg); 
          border: 2px solid #fefce8;
        }
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
      </style>
      <div class="card">
        ${promo ? '<span class="promo-badge">Promo!</span>' : ''}
        <div class="card-img-wrapper">
            <img src="${img}" alt="${name}" class="card-img" onerror="this.onerror=null;this.src='${placeholderUrl}';">
        </div>
        <div class="card-body">
          <h3 class="card-title">${name}</h3>
          ${description ? `<p class="card-description">${description}</p>` : ''}
          <div class="price-section">
            <span class="price-current">R$ ${price.replace('.', ',')}</span>
            ${oldPrice ? `<span class="price-old">R$ ${parseFloat(oldPrice).toFixed(2).replace('.', ',')}</span>` : ''}
          </div>
          <button class="add-btn" aria-label="Adicionar ${name} ao carrinho por R$ ${price.replace('.', ',')}">Adicionar</button>
        </div>
      </div>
    `;

    this.shadowRoot.querySelector('.add-btn').addEventListener('click', () => {
      this.dispatchEvent(new CustomEvent('addToCart', {
        bubbles: true,
        composed: true,
        detail: {
            id: this.getAttribute('id'),
            name: name,
            price: parseFloat(price)
        }
      }));
    });
  }
}
customElements.define('product-card', ProductCard);

// L√≥gica principal da aplica√ß√£o
document.addEventListener('DOMContentLoaded', () => {

    const menuData = {
        "üçî Combos T√¥ Com Fome": [
            { id: "combo-x-tudao-monstro", name: "Combo X-Tud√£o Monstro + Fritas + Ativ Plus 290ml", price: 25.99, oldPrice: 29.99, promo: true, description: "Um lanche absurdamente completo pra quem n√£o t√° de brincadeira com a fome!", img: "https://i.imgur.com/g8n15vW.png" },
            { id: "combo-familia-x-tudao", name: "Combo Fam√≠lia X-Tud√£o 4 X-Tud√µes + 4 refris ou 2lt Mantig + batata", price: 99.90, oldPrice: 129.99, promo: true, description: "Duas suculentas carnes de 56g cada, crocantes.", img: "https://i.imgur.com/G5Gf3p7.png" },
            { id: "combo-top-3-x-tudao", name: "Combo Top 3 X-Tud√£o + 3 refris ou 2lt Mantig + batata grande", price: 89.90, oldPrice: 119.90, promo: true, description: "Duas suculentas carnes de 56g cada, crocantes.", img: "https://i.imgur.com/B942i6B.png" },
            { id: "combo-casal-x-tudao", name: "Combo Casal 2 X-Tud√£o + 2 refris ou 2lt Mantig + batata grande", price: 79.90, oldPrice: 109.90, promo: true, description: "Duas suculentas carnes de 56g cada, crocantes.", img: "https://i.imgur.com/L530Dwe.png" },
            { id: "combo-artesanal-classico", name: "Combo Artesanal Cl√°ssico + Fritas + Coca Cola Lata", price: 29.99, oldPrice: 34.99, promo: true, description: "Combo Artesanal Explos√£o De Sabor. P√£o macio, cheddar cremoso, carne artesanal.", img: "https://i.imgur.com/XwE4rQt.png" },
        ],
        "üåü Lanches Especiais": [
            { id: "fome-zero", name: "Fome zero", price: 23.99, oldPrice: 29.90, promo: true, description: "P√£o com gergelim, Smash Burguer 120g, queijo mussarela e maionese simples.", img: "https://i.imgur.com/1G6K2hP.png" },
            { id: "fominha-classica", name: "Fominha cl√°ssica", price: 26.99, oldPrice: 32.99, promo: true, description: "P√£o com gergelim, Smash Burguer 120g, queijo mussarela, tomate, alface.", img: "https://i.imgur.com/7T6k5Hk.png" },
            { id: "fome-de-leao-com-fritas", name: "Fome de Le√£o Com Fritas", price: 28.90, oldPrice: 35.99, promo: true, description: "P√£o com gergelim, Smash Burguer 120g, bacon crocante, cheddar duplo e maionese.", img: "https://i.imgur.com/O6M3P0j.png" },
            { id: "to-morrendo-de-fome-com-fritas", name: "T√¥ Morrendo de Fome Com Fritas", price: 32.90, oldPrice: 49.99, promo: true, description: "P√£o com gergelim, 2 Smash Burguer 120g, cheddar, tomate, alface e muito bacon, ketchup.", img: "https://i.imgur.com/tHqgPA6.png" },
            { id: "x-vr-monstro-com-fritas", name: "X-Vr Monstro Com Fritas", price: 39.90, oldPrice: 59.90, promo: true, description: "P√£o com gergelim, 3 Smash Burguer 120g, muito cheddar, duplo bacon, molho barbecue.", img: "https://i.imgur.com/a4fIZnE.png" },
            { id: "x-treme-4-carnes-com-batata-frita", name: "X-Treme 4 Carnes Com Batata Frita", price: 49.90, oldPrice: 65.90, promo: true, description: "X-Treme 4 Carnes. Um verdadeiro monstro do sabor: 4 hamb√∫rgueres.", img: "https://i.imgur.com/wFj3z7L.png" },
        ],
        "üçî Lanches": [
            { id: "x-burguer", name: "X-Burguer", price: 13.99, description: "P√£o, carne bovina 56g, queijo mussarela, maionese, ketchup, mostarda.", img: "https://i.imgur.com/T0D1sBD.png" },
            { id: "x-salada", name: "X-Salada", price: 14.99, description: "P√£o, carne 56g, alface, tomate, queijo mussarela, maionese, ketchup, mostarda.", img: "https://i.imgur.com/5JHYL4P.png" },
            { id: "x-egg", name: "X-egg", price: 16.99, description: "P√£o, carne 56g, ovo, queijo mussarela, tomate, alface, maionese, ketchup, mostarda.", img: "https://i.imgur.com/7uS19Fw.png" },
            { id: "x-egg-bacon", name: "X-egg bacon", price: 17.99, description: "P√£o, carne 56g, bacon, ovo, tomate, alface, queijo mussarela, ketchup, maionese.", img: "https://i.imgur.com/i9B0YmK.png" },
            { id: "x-tudao", name: "X-Tud√£o", price: 21.99, oldPrice: 25.99, promo: true, description: "P√£o, 2 carne 56g, bacon, ovo, queijo mussarela, tomate, alface, ketchup, maionese.", img: "https://i.imgur.com/YvVjV4Q.png" },
        ],
        "üçü Acompanhamentos": [
            { id: "batata-frita-simples", name: "Batata Frita Simples", price: 15.99, img: "https://i.imgur.com/U8z3zY5.png" },
            { id: "batata-suprema-com-bacon", name: "Batata Suprema com bacon grande", price: 19.99, oldPrice: 21.99, promo: true, img: "https://i.imgur.com/b3x2E0Q.png" },
            { id: "batata-que-fome-com-calabresa", name: "Batata que fome com calabresa grande", price: 19.99, oldPrice: 24.99, promo: true, img: "https://i.imgur.com/W2uP6pP.png" },
            { id: "mini-batata-com-calabresa", name: "Mini batata com Calabresa", price: 5.99, description: "Batata frita crocante em por√ß√£o menor, coberta com cheddar derretido e calabresa.", img: "https://i.imgur.com/bSjXpPC.png" },
            { id: "aneis-cebola-p", name: "An√©is de Cebola Crocantes - P", price: 18.90, description: "8 deliciosos an√©is de cebola empanados.", img: "https://i.imgur.com/v2E2m7b.png" },
            { id: "aneis-cebola-m", name: "An√©is de Cebola Crocantes - M", price: 25.90, description: "12 deliciosos an√©is de cebola empanados.", img: "https://i.imgur.com/v2E2m7b.png" },
            { id: "aneis-cebola-g", name: "An√©is de Cebola Crocantes - G", price: 32.90, description: "16 deliciosos an√©is de cebola empanados.", img: "https://i.imgur.com/v2E2m7b.png" },
            { id: "aneis-cebola-gg", name: "An√©is de Cebola Crocantes - GG", price: 39.90, description: "20 deliciosos an√©is de cebola empanados.", img: "https://i.imgur.com/v2E2m7b.png" },
        ],
        "ü•§ Bebidas": [
            { id: "guarana-mantiqueira-2l", name: "Refrigerante Guaran√° Mantiqueira Garrafa 2L", price: 9.99, img: "https://i.imgur.com/L1nF1s4.png" },
            { id: "coca-cola-lata", name: "Coca-Cola Original 350ml Lata", price: 5.99, img: "https://i.imgur.com/J3aD42B.png" },
            { id: "guarana-antarctica-237ml", name: "Guaran√° Antarctica 237ml", price: 4.99, img: "https://i.imgur.com/R3O2V5R.png" },
            { id: "ativ-plus-guarana-290ml", name: "Suco Ativ Plus Guaran√° Copo 290ml", price: 3.99, img: "https://i.imgur.com/Y7xG9bH.png" },
        ]
    };

    let cart = JSON.parse(localStorage.getItem('tocomfomevr_cart')) || [];
    let isConfirmingClear = false;
    let confirmTimeout;

    const cartIcon = document.getElementById('cart-icon');
    const cartCount = document.getElementById('cart-count');
    const cartItemsContainer = document.getElementById('cart-items-container');
    const cartEmptyMsg = document.getElementById('cart-empty-msg');
    const cartTotalSpan = document.getElementById('cart-total');
    const checkoutBtn = document.getElementById('checkout-btn');
    const addressInput = document.getElementById('address');
    const menuSection = document.getElementById('menu');
    const toastContainer = document.getElementById('toast-container');
    const cartModal = document.getElementById('cart-modal');
    const cartBackdrop = document.getElementById('cart-backdrop');
    const closeCartBtn = document.getElementById('close-cart-btn');
    const categoryButtonsContainer = document.getElementById('category-buttons-container');
    const clearCartBtn = document.getElementById('clear-cart-btn');
    
    // N√öMERO CORRIGIDO PARA +5524999219813
    const WHATSAPP_NUMBER = '5524999219813';

    const openCart = () => {
        cartModal.classList.remove('translate-x-full');
        cartBackdrop.classList.remove('hidden');
        document.body.style.overflow = 'hidden'; // Previne scroll do body quando o carrinho est√° aberto
        // Foco no bot√£o de fechar para melhorar acessibilidade
        setTimeout(() => closeCartBtn.focus(), 100);
    };

    const closeCart = () => {
        cartModal.classList.add('translate-x-full');
        cartBackdrop.classList.add('hidden');
        document.body.style.overflow = 'auto'; // Restaura scroll do body
        // Devolve o foco para o √≠cone do carrinho
        cartIcon.focus();
    };

    cartIcon.addEventListener('click', openCart);
    closeCartBtn.addEventListener('click', closeCart);
    cartBackdrop.addEventListener('click', closeCart);

    // Adicionar suporte a teclado para abrir/fechar o carrinho
    cartIcon.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            openCart();
        }
    });

    closeCartBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeCart();
        }
    });

    // Fechar carrinho com a tecla Escape
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !cartModal.classList.contains('translate-x-full')) {
            closeCart();
        }
    });

    const sanitizeId = (text) => {
        return text.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
    };

    const renderCategoryNav = () => {
        const categories = Object.keys(menuData);
        categoryButtonsContainer.innerHTML = categories.map(category => {
            const categoryId = sanitizeId(category);
            return `<a href="#category-${categoryId}" class="category-btn px-4 py-2 rounded-full text-sm shadow-sm">${category}</a>`;
        }).join('');
    };

    const renderMenu = () => {
        let menuHTML = '';
        const categories = Object.keys(menuData);

        categories.forEach((category) => {
            const categoryId = `category-${sanitizeId(category)}`;
            menuHTML += `
                <section id="${categoryId}">
                    <h2 class="section-title">${category}</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                        ${menuData[category].map((item, i) => `
                            <div style="animation-delay: ${i * 100}ms">
                                <product-card
                                    id="${item.id}"
                                    name="${item.name}"
                                    price="${item.price}"
                                    ${item.oldPrice ? `oldPrice="${item.oldPrice}"` : ''}
                                    ${item.promo ? `promo="true"` : ''}
                                    ${item.description ? `description="${item.description}"` : ''}
                                    img="${item.img}"
                                ></product-card>
                            </div>
                        `).join('')}
                    </div>
                </section>
            `;
        });
        menuSection.innerHTML = menuHTML;
    };

    menuSection.addEventListener('addToCart', (event) => {
        const product = event.detail;
        const existingProductIndex = cart.findIndex(item => item.id === product.id);

        if (existingProductIndex > -1) {
            cart[existingProductIndex].quantity++;
        } else {
            cart.push({ ...product, quantity: 1 });
        }
        showToast(`${product.name} adicionado!`);
        updateCart();
    });

    const updateCart = () => {
        renderCartItems();
        updateCartTotal();
        updateCartIconCount();
        checkCheckoutButton();
        updateClearCartButtonState();
        localStorage.setItem('tocomfomevr_cart', JSON.stringify(cart));
    };

    const renderCartItems = () => {
        if (cart.length === 0) {
            cartEmptyMsg.style.display = 'block';
            cartItemsContainer.innerHTML = '';
            cartItemsContainer.appendChild(cartEmptyMsg);
        } else {
            cartEmptyMsg.style.display = 'none';
            cartItemsContainer.innerHTML = cart.map(item => `
                <div class="cart-item flex justify-between items-center bg-white p-3 rounded-lg shadow-sm" data-id="${item.id}">
                    <div class="flex-grow pr-3">
                        <p class="font-bold text-sm leading-tight">${item.name}</p>
                        <p class="text-xs text-gray-600">R$ ${item.price.toFixed(2).replace('.', ',')} 
                            <span class="cart-item-total">= R$ ${(item.price * item.quantity).toFixed(2).replace('.', ',')}</span>
                        </p>
                    </div>
                    <div class="flex items-center space-x-2 cart-item-controls">
                        <button class="decrease-qty bg-red-500 text-white rounded-md font-bold w-7 h-7 flex items-center justify-center transition-transform hover:scale-110" aria-label="Reduzir quantidade">-</button>
                        <span class="font-bold w-6 text-center">${item.quantity}</span>
                        <button class="increase-qty bg-green-500 text-white rounded-md font-bold w-7 h-7 flex items-center justify-center transition-transform hover:scale-110" aria-label="Aumentar quantidade">+</button>
                        <button class="remove-item-btn" aria-label="Remover item do carrinho">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }
    };
    
    cartItemsContainer.addEventListener('click', (event) => {
        const target = event.target.closest('button');
        if (!target) return;

        const cartItemDiv = target.closest('.cart-item');
        const productId = cartItemDiv.dataset.id;
        const productIndex = cart.findIndex(item => item.id === productId);

        if(productIndex === -1) return;

        if (target.classList.contains('increase-qty')) {
            cart[productIndex].quantity++;
            showToast(`Quantidade de ${cart[productIndex].name} aumentada.`);
        } else if (target.classList.contains('decrease-qty')) {
            cart[productIndex].quantity--;
            if (cart[productIndex].quantity === 0) {
                showToast(`${cart[productIndex].name} removido do carrinho.`);
                cart.splice(productIndex, 1);
            } else {
                showToast(`Quantidade de ${cart[productIndex].name} reduzida.`);
            }
        } else if (target.classList.contains('remove-item-btn')) {
            showToast(`${cart[productIndex].name} removido do carrinho.`);
            cart.splice(productIndex, 1);
        }
        
        updateCart();
    });

    const updateCartTotal = () => {
        const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        cartTotalSpan.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
    };

    const updateCartIconCount = () => {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;
        // Atualiza o texto do aria-label para acessibilidade
        cartIcon.setAttribute('aria-label', `Abrir carrinho de compras - Itens no carrinho: ${totalItems}`);
    };

    const checkCheckoutButton = () => {
        const address = addressInput.value.trim();
        // Valida√ß√£o de endere√ßo mais robusta
        const isValidAddress = address.length >= 5 && address.includes(' '); // M√≠nimo 5 caracteres e pelo menos um espa√ßo
        checkoutBtn.disabled = !(cart.length > 0 && isValidAddress);
    };

    const resetClearCartButton = () => {
        isConfirmingClear = false;
        clearTimeout(confirmTimeout);
        clearCartBtn.innerHTML = '<i class="fas fa-trash-alt mr-1" aria-hidden="true"></i> Esvaziar';
        clearCartBtn.classList.remove('text-red-700', 'font-bold');
    };

    const updateClearCartButtonState = () => {
        if (cart.length > 0) {
            clearCartBtn.classList.remove('hidden');
        } else {
            clearCartBtn.classList.add('hidden');
            resetClearCartButton();
        }
    };
    
    clearCartBtn.addEventListener('click', () => {
        if (isConfirmingClear) {
            cart = [];
            showToast('Carrinho esvaziado!', 'success');
            updateCart();
            resetClearCartButton();
        } else {
            isConfirmingClear = true;
            clearCartBtn.innerHTML = 'Tem certeza?';
            clearCartBtn.classList.add('text-red-700', 'font-bold');
            confirmTimeout = setTimeout(resetClearCartButton, 4000);
        }
    });

    const showToast = (message, type = 'success') => {
        const toast = document.createElement('div');
        toast.textContent = message;
        toast.className = 'toast-notification';
        toast.classList.add(type === 'error' ? 'toast-error' : 'toast-success');
        toast.setAttribute('role', 'alert');
        toast.setAttribute('aria-live', 'assertive');
        toastContainer.appendChild(toast);

        setTimeout(() => {
            toast.classList.add('show');
        }, 10);

        setTimeout(() => {
            toast.classList.remove('show');
            toast.addEventListener('transitionend', () => toast.remove());
        }, 3000);
    };
    
    addressInput.addEventListener('input', checkCheckoutButton);

    checkoutBtn.addEventListener('click', () => {
        const address = addressInput.value.trim();
        if (cart.length === 0) {
            showToast("Seu carrinho est√° vazio!", 'error');
            return;
        }
        
        // Valida√ß√£o mais robusta do endere√ßo
        if (address.length < 5 || !address.includes(' ')) {
            showToast("Por favor, informe um endere√ßo v√°lido com rua e n√∫mero.", 'error');
            addressInput.focus();
            return;
        }

        let message = "Ol√°, T√î COM FOME VR! üëãüçî\nGostaria de fazer o seguinte pedido:\n\n";
        cart.forEach(item => {
            message += `*${item.quantity}x* - ${item.name} - R$ ${(item.price * item.quantity).toFixed(2).replace('.', ',')}\n`;
        });
        const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        message += `\n*Total:* R$ ${total.toFixed(2).replace('.', ',')}\n`;
        message += `\n*Endere√ßo para entrega:*\n${address}`;
        message += `\n\n*Observa√ß√µes:*\n`;

        const encodedMessage = encodeURIComponent(message);
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`, '_blank');
    });

    // Inicializa√ß√£o da aplica√ß√£o
    renderCategoryNav();
    renderMenu();
    updateCart();
    
    // Adicionar suporte a teclado para os bot√µes de categoria
    categoryButtonsContainer.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.target.click();
        }
    });
});
</script>
</body>
</html>
